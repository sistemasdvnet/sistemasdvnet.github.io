"use strict";(self.webpackChunkpaginapwa=self.webpackChunkpaginapwa||[]).push([[468],{5468:(O,p,r)=>{r.r(p),r.d(p,{GuardiaModule:()=>I});var h=r(7423),m=r(5245),C=r(7531),g=r(9685),u=r(9808),l=r(3075),t=r(5e3),f=r(6649),c=r(8553),v=r(9709);let G=(()=>{class a{constructor(e,i,s){this.templateRef=e,this.viewContainer=i,this.authService=s,this.currentUser={}}ngOnInit(){this.currentUser=this.authService.getCurrentUser(),this.updateView()}set appMenurole(e){this.permission=e,this.updateView()}updateView(){this.viewContainer.clear(),this.checkPermission()&&this.viewContainer.createEmbeddedView(this.templateRef)}checkPermission(){let e=!1;if(this.currentUser&&this.currentUser.role)for(const i of this.permission)this.currentUser.role==i&&(e=!0);return e}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.Rgc),t.Y36(t.s_b),t.Y36(c.e))},a.\u0275dir=t.lG2({type:a,selectors:[["","appMenurole",""]],inputs:{appMenurole:"appMenurole"}}),a})();var d=r(6696);function T(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return s.delete(s.id)}),t._uU(1,"Eliminar"),t.qZA()}}let Z=(()=>{class a{constructor(e,i,s){this.router=e,this.guardService=i,this.authServ=s,this.id="",this.name="",this.user="",this.cedula="",this.ciudadela="",this.etapa="",this.currentUser={}}ngOnInit(){this.authServ.getCurrentUser(),this.currentUser=this.authServ.currentUser}edit(e){this.router.navigateByUrl(`/auth/guardia/${e}`)}delete(e){this.guardService.deleteGuard(e).subscribe(i=>{window.location.reload()})}buttonDelete(){return this.currentUser.id!=this.id}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.F0),t.Y36(f.F),t.Y36(c.e))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-infoguardias"]],inputs:{id:"id",name:"name",user:"user",cedula:"cedula",ciudadela:"ciudadela",etapa:"etapa"},decls:16,vars:10,consts:[[1,"container"],["role","toolbar","aria-label","Toolbar with button groups",1,"btn-toolbar","justify-content-between"],["type","text",1,"form-control-plaintext"],["role","group","aria-label","First group",1,"btn-group"],[1,"btn-group"],["type","button",1,"btn","btn-info","btn-sm","mr-2",3,"click"],["type","button","class","btn btn-danger btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.TgZ(5,"div",3)(6,"label",2),t._uU(7),t.ALo(8,"uppercase"),t.qZA()(),t.TgZ(9,"div",4)(10,"button",5),t.NdJ("click",function(){return i.edit(i.id)}),t._uU(11,"Editar"),t.qZA(),t.YNc(12,T,2,0,"button",6),t.qZA(),t.TgZ(13,"label",2),t._uU(14),t.ALo(15,"uppercase"),t.qZA()()()),2&e&&(t.xp6(3),t.hij("Nombre: ",t.lcZ(4,4,i.name),""),t.xp6(4),t.hij("Usuario: ",t.lcZ(8,6,i.user),""),t.xp6(5),t.Q6J("ngIf",i.buttonDelete()),t.xp6(2),t.hij("C\xe9dula: ",t.lcZ(15,8,i.cedula),""))},directives:[u.O5],pipes:[u.gd],styles:[""]}),a})();function y(a,n){1&a&&(t.TgZ(0,"option",18),t._uU(1,"Todas"),t.qZA())}function U(a,n){if(1&a&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}const A=function(){return["root"]};function x(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",14,15),t.NdJ("change",function(){t.CHM(e);const s=t.MAs(1);return t.oxw().selectCiudadela(s.value)}),t.YNc(2,y,2,0,"option",16),t.YNc(3,U,2,2,"option",17),t.qZA()}if(2&a){const e=t.oxw();t.xp6(2),t.Q6J("appMenurole",t.DdM(2,A)),t.xp6(1),t.Q6J("ngForOf",e.ciudadelas)}}function M(a,n){if(1&a&&(t.TgZ(0,"label",20),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.ciudadela)}}function q(a,n){if(1&a&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function J(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",21,22),t.NdJ("change",function(){t.CHM(e);const s=t.MAs(1);return t.oxw().selectEtapa(s.value)}),t.TgZ(2,"option",18),t._uU(3,"Todas"),t.qZA(),t.YNc(4,q,2,2,"option",17),t.qZA()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.etapas)}}function S(a,n){if(1&a&&(t.TgZ(0,"label",20),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.etapa)}}function F(a,n){if(1&a&&(t.TgZ(0,"div")(1,"div",23),t._UZ(2,"app-infoguardias",24),t.qZA()()),2&a){const e=n.$implicit;t.xp6(2),t.Q6J("id",e._id)("user",e.user)("cedula",e.cedula)("name",e.name)("ciudadela",e.ciudadela)("etapa",e.etapa)}}function w(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){return t.CHM(e),t.oxw().onTop()}),t.TgZ(1,"mat-icon"),t._uU(2,"arrow_drop_up"),t.qZA()()}}const _=function(){return["root","admin"]},b=function(){return["guard"]},N=function(){return["/auth/guardia"]},Y=[{path:"guardias",component:(()=>{class a{constructor(e,i,s,o){this.guardiaService=e,this.authServ=i,this.data=s,this.document=o,this.name="",this.currentUser={},this.guardias=[],this.ciudadela="",this.ciudadelas=[],this.etapa="",this.etapas=[],this.lista_filtrada=[],this.allGuardsCiudadelas=[],this.buttonUp=!1,this.page=1,this.query={}}onWindowScroll(){const e=window.pageYOffset;this.buttonUp=(e||this.document.documentElement.scrollTop)>200}ngOnInit(){this.authServ.getCurrentUser(),this.currentUser=this.authServ.currentUser,this.setGuardByCurrentUser()}setGuardByCurrentUser(){"guard"==this.currentUser.role&&this.authServ.getUserById(this.currentUser.id).subscribe(e=>{this.setGuardiasForGuard(e)}),"root"==this.currentUser.role&&(this.setAllCiudadelas(),this.setAllGuards(this.page)),"admin"==this.currentUser.role&&this.authServ.getUserById(this.currentUser.id).subscribe(e=>{this.setGuardiasForAdmins(e)})}busqueda(){let e=this.name;this.guardias=[],this.page=1,this.query.name=e,this.setAllGuards(this.page,this.query),this.name=e}setGuardiasForGuard(e){this.query={ciudadela:e.ciudadela,etapa:e.etapa},this.data.findCiudadelaById(e.ciudadela).subscribe(i=>{this.ciudadela=i.name}),this.data.findEtapasById(e.etapa).subscribe(i=>{this.etapa=i.name}),this.setAllGuards(this.page,this.query)}setAllCiudadelas(){this.data.getCiudadelas().subscribe(e=>{this.ciudadelas=e})}setGuardiasForAdmins(e){this.ciudadelas=e.ciudadelasCargo,this.selectCiudadela(e.ciudadelasCargo[0]._id)}setGuardByCiudadelas(){let e=[];for(var i=0;i<this.ciudadelas.length;i++)this.guardiaService.findGuardByCiudadela(this.ciudadelas[i]._id).subscribe(s=>{Array.prototype.push.apply(e,s)});this.guardias=e,this.allGuardsCiudadelas=e}matchGuards(e){let i=[];for(var s=0;s<this.allGuardsCiudadelas.length;s++)for(var o=0,E=e.length;o<E;o++)this.allGuardsCiudadelas[s]._id===e[o]._id&&i.push(this.allGuardsCiudadelas[s]);this.guardias=i,this.lista_filtrada=this.guardias}selectCiudadela(e){this.ciudadela=e,this.setEtapas(e),this.guardias=[],this.page=1,this.query.etapa="",this.query.ciudadela="Todas"==e?"":e,this.setAllGuards(this.page,this.query)}setEtapas(e){this.data.findEtapasByCiudadelaId(e).subscribe(i=>{this.etapas=i})}selectEtapa(e){this.guardias=[],this.page=1,this.query.villa="",this.query.etapa="Todas"==e?"":e,this.setAllGuards(this.page,this.query)}search(){}onTop(){this.document.documentElement.scrollTop=0}onScrollDown(){this.page+=1,this.setAllGuards(this.page,this.query)}setAllGuards(e,i){this.guardiaService.findGuardias(e,i).subscribe(s=>{this.page<=s.items.totalPages&&s.items.docs.forEach(o=>{this.guardias.push(o)})}),this.name="",this.query.name=""}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(f.F),t.Y36(c.e),t.Y36(v.D),t.Y36(u.K0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-guardias"]],hostBindings:function(e,i){1&e&&t.NdJ("scroll",function(){return i.onWindowScroll()},!1,t.Jf7)},decls:25,vars:15,consts:[[1,"container"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon3",1,"input-group-text"],["class","form-control",3,"change",4,"appMenurole"],["class","form-control","id","ciudadela","readonly","",4,"appMenurole"],["class","form-control","id","ciudadela",3,"change",4,"appMenurole"],["type","text","id","usuario","placeholder","Nombre",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"list-group"],[1,"list-group-item","list-group-item-action","active",3,"routerLink"],["infinite-scroll","",1,"search_result",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],[4,"ngFor","ngForOf"],["mat-mini-fab","","class","upButton",3,"click",4,"ngIf"],[1,"form-control",3,"change"],["c",""],["selected","",4,"appMenurole"],[3,"value",4,"ngFor","ngForOf"],["selected",""],[3,"value"],["id","ciudadela","readonly","",1,"form-control"],["id","ciudadela",1,"form-control",3,"change"],["e",""],[1,"list-group-item","list-group-item-action","mb-1"],[3,"id","user","cedula","name","ciudadela","etapa"],["mat-mini-fab","",1,"upButton",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Guardias"),t.qZA(),t.TgZ(3,"div",1)(4,"div",2)(5,"span",3),t._uU(6,"Ciudadela"),t.qZA()(),t.YNc(7,x,4,3,"select",4),t.YNc(8,M,2,1,"label",5),t.qZA(),t.TgZ(9,"div",1)(10,"div",2)(11,"span",3),t._uU(12,"Etapa"),t.qZA()(),t.YNc(13,J,5,1,"select",6),t.YNc(14,S,2,1,"label",5),t.qZA(),t.TgZ(15,"div",1)(16,"input",7),t.NdJ("ngModelChange",function(o){return i.name=o}),t.qZA(),t.TgZ(17,"button",8),t.NdJ("click",function(){return i.busqueda()}),t._uU(18," Buscar "),t.qZA()(),t.TgZ(19,"div",9)(20,"a",10),t._uU(21," Crear nuevo guardia "),t.qZA(),t.TgZ(22,"div",11),t.NdJ("scrolled",function(){return i.onScrollDown()}),t.YNc(23,F,3,6,"div",12),t.qZA(),t.YNc(24,w,3,0,"button",13),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("appMenurole",t.DdM(10,_)),t.xp6(1),t.Q6J("appMenurole",t.DdM(11,b)),t.xp6(5),t.Q6J("appMenurole",t.DdM(12,_)),t.xp6(1),t.Q6J("appMenurole",t.DdM(13,b)),t.xp6(2),t.Q6J("ngModel",i.name),t.xp6(4),t.Q6J("routerLink",t.DdM(14,N)),t.xp6(2),t.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",50),t.xp6(1),t.Q6J("ngForOf",i.guardias),t.xp6(1),t.Q6J("ngIf",i.buttonUp))},directives:[G,l.YN,l.Kr,u.sg,l.Fj,l.JJ,l.On,d.yS,g.Ry,Z,u.O5,h.lW,m.Hw],styles:[""]}),a})()},{path:"",redirectTo:"guardias"}];let B=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[d.Bz.forChild(Y)],d.Bz]}),a})(),I=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[u.ez,B,l.u5,g.Rq,C.c,m.Ps,h.ot]]}),a})()}}]);