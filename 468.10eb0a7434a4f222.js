"use strict";(self.webpackChunkpaginapwa=self.webpackChunkpaginapwa||[]).push([[468],{5468:(C,g,u)=>{u.r(g),u.d(g,{GuardiaModule:()=>F});var c=u(9808),d=u(3075),t=u(5e3),_=u(6649),m=u(8553),l=u(9709);let f=(()=>{class a{constructor(e,i,r){this.templateRef=e,this.viewContainer=i,this.authService=r,this.currentUser={}}ngOnInit(){this.id=sessionStorage.getItem("id"),"string"==typeof this.id&&this.authService.getUserById(this.id).subscribe(e=>{this.currentUser=e,this.updateView()})}set appMenurole(e){this.permission=e,this.updateView()}updateView(){this.viewContainer.clear(),this.checkPermission()&&this.viewContainer.createEmbeddedView(this.templateRef)}checkPermission(){let e=!1;if(this.currentUser&&this.currentUser.role)for(const i of this.permission)this.currentUser.role==i&&(e=!0);return e}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.Rgc),t.Y36(t.s_b),t.Y36(m.e))},a.\u0275dir=t.lG2({type:a,selectors:[["","appMenurole",""]],inputs:{appMenurole:"appMenurole"}}),a})();var s=u(6696);function p(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.delete(r.id)}),t._uU(1,"Eliminar"),t.qZA()}}let G=(()=>{class a{constructor(e,i){this.router=e,this.guardService=i,this.id="",this.name="",this.user="",this.cedula="",this.ciudadela="",this.etapa="",this.currentUser=!0}ngOnInit(){this.bottonDelete()}edit(e){this.router.navigateByUrl(`/auth/guardia/${e}`)}delete(e){this.guardService.deleteGuard(e).subscribe(i=>{window.location.reload()})}bottonDelete(){this.idCurrent=sessionStorage.getItem("id"),this.currentUser=this.idCurrent!=this.id}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(s.F0),t.Y36(_.F))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-infoguardias"]],inputs:{id:"id",name:"name",user:"user",cedula:"cedula",ciudadela:"ciudadela",etapa:"etapa"},decls:16,vars:10,consts:[[1,"container"],["role","toolbar","aria-label","Toolbar with button groups",1,"btn-toolbar","justify-content-between"],["type","text",1,"form-control-plaintext"],["role","group","aria-label","First group",1,"btn-group"],[1,"btn-group"],["type","button",1,"btn","btn-info","btn-sm","mr-2",3,"click"],["type","button","class","btn btn-danger btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"label",2),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.TgZ(5,"div",3)(6,"label",2),t._uU(7),t.ALo(8,"uppercase"),t.qZA()(),t.TgZ(9,"div",4)(10,"button",5),t.NdJ("click",function(){return i.edit(i.id)}),t._uU(11,"Editar"),t.qZA(),t.YNc(12,p,2,0,"button",6),t.qZA(),t.TgZ(13,"label",2),t._uU(14),t.ALo(15,"uppercase"),t.qZA()()()),2&e&&(t.xp6(3),t.hij("Nombre: ",t.lcZ(4,4,i.name),""),t.xp6(4),t.hij("Usuario: ",t.lcZ(8,6,i.user),""),t.xp6(5),t.Q6J("ngIf",i.currentUser),t.xp6(2),t.hij("C\xe9dula: ",t.lcZ(15,8,i.cedula),""))},directives:[c.O5],pipes:[c.gd],styles:[""]}),a})();function y(a,n){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function Z(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",13,14),t.NdJ("change",function(){t.CHM(e);const r=t.MAs(1);return t.oxw().selectCiudadela(r.value)}),t.TgZ(2,"option",15),t._uU(3,"Todas"),t.qZA(),t.YNc(4,y,2,2,"option",16),t.qZA()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.ciudadelas)}}function T(a,n){if(1&a&&(t.TgZ(0,"label",18),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.texto_ciudadela)}}function M(a,n){if(1&a&&(t.TgZ(0,"option",17),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function x(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"select",19,20),t.NdJ("change",function(){t.CHM(e);const r=t.MAs(1);return t.oxw().selectEtapa(r.value)}),t.TgZ(2,"option",15),t._uU(3,"Todas"),t.qZA(),t.YNc(4,M,2,2,"option",16),t.qZA()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngForOf",e.etapas)}}function A(a,n){if(1&a&&(t.TgZ(0,"label",18),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.texto_etapa)}}function $(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().search()}),t._uU(1,"Buscar por"),t.qZA()}}function U(a,n){if(1&a&&(t.TgZ(0,"div")(1,"div",21),t._UZ(2,"app-infoguardias",22),t.qZA()()),2&a){const e=n.$implicit;t.xp6(2),t.Q6J("id",e._id)("user",e.user)("cedula",e.cedula)("name",e.name)("ciudadela",e.ciudadela)("etapa",e.etapa)}}const v=function(){return["root","admin"]},b=function(){return["guard"]},E=function(){return["/auth/guardia"]},B=[{path:"guardias",component:(()=>{class a{constructor(e,i,r){this.guardiaService=e,this.authServ=i,this.data=r,this.name="",this.guardias=[],this.ciudadelas=[],this.etapas=[],this.texto_ciudadela="",this.texto_etapa="",this.lista_filtrada=[],this.allGuardsCiudadelas=[],this.ciudadela=""}ngOnInit(){this.setGuardByCurrentUser()}setGuardByCurrentUser(){this.id=sessionStorage.getItem("id"),"string"==typeof this.id&&this.authServ.getUserById(this.id).subscribe(e=>{"guard"==e.role&&this.setGuardiasForGuard(e),"root"==e.role&&this.setAllGuardias(),"admin"==e.role&&this.setGuardiasForAdmins(e)})}busqueda(){let e=[],i=[];this.guardiaService.findGuardByName(this.name).subscribe(r=>{e=0!=this.lista_filtrada.length?this.lista_filtrada:this.allGuardsCiudadelas;for(var o=0;o<r.length;o++)for(var h=0;h<e.length;h++)r[o]._id===e[h]._id&&i.push(e[h]);this.guardias=i})}setGuardiasForGuard(e){this.data.findCiudadelaById(e.ciudadela).subscribe(i=>{this.texto_ciudadela=i.name}),this.data.findEtapasById(e.etapa).subscribe(i=>{this.texto_etapa=i.name}),this.guardiaService.findGuardByEtapa(e.etapa).subscribe(i=>{this.guardias=i})}setAllGuardias(){this.data.getCiudadelas().subscribe(e=>{this.ciudadelas=e,this.setGuardByCiudadelas()})}setGuardiasForAdmins(e){this.ciudadelas=e.ciudadelasCargo,this.setGuardByCiudadelas(),1==this.ciudadelas.length&&(this.texto_ciudadela=e.ciudadelasCargo[0].name,this.setEtapas(e.ciudadelasCargo[0]._id),this.guardiaService.findGuardByCiudadela(e.ciudadelasCargo[0]._id).subscribe(i=>{this.guardias=i}))}setGuardByCiudadelas(){let e=[];for(var i=0;i<this.ciudadelas.length;i++)this.guardiaService.findGuardByCiudadela(this.ciudadelas[i]._id).subscribe(r=>{Array.prototype.push.apply(e,r)});this.guardias=e,this.allGuardsCiudadelas=e}matchGuards(e){let i=[];for(var r=0;r<this.allGuardsCiudadelas.length;r++)for(var o=0,h=e.length;o<h;o++)this.allGuardsCiudadelas[r]._id===e[o]._id&&i.push(this.allGuardsCiudadelas[r]);this.guardias=i,this.lista_filtrada=this.guardias}selectCiudadela(e){this.ciudadela=e,this.setEtapas(e),"Todas"!=e?this.guardiaService.findGuardByCiudadela(e).subscribe(i=>{this.matchGuards(i)}):(this.lista_filtrada=[],this.setGuardByCiudadelas())}setEtapas(e){this.data.findEtapasByCiudadelaId(e).subscribe(i=>{this.etapas=i})}selectEtapa(e){"Todas"!=e?this.guardiaService.findGuardByEtapa(e).subscribe(i=>{this.matchGuards(i)}):(this.lista_filtrada=[],this.selectCiudadela(this.ciudadela))}search(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(_.F),t.Y36(m.e),t.Y36(l.D))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-guardias"]],decls:25,vars:14,consts:[[1,"container"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon3",1,"input-group-text"],["class","form-control",3,"change",4,"appMenurole"],["class","form-control","id","ciudadela","readonly","",4,"appMenurole"],["class","form-control","id","ciudadela",3,"change",4,"appMenurole"],["class","btn btn-primary",3,"click",4,"appMenurole"],["type","text","id","usuario","placeholder","Nombre",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"],[1,"list-group"],[1,"list-group-item","list-group-item-action","active",3,"routerLink"],[4,"ngFor","ngForOf"],[1,"form-control",3,"change"],["c",""],["selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["id","ciudadela","readonly","",1,"form-control"],["id","ciudadela",1,"form-control",3,"change"],["e",""],[1,"list-group-item","list-group-item-action","mb-1"],[3,"id","user","cedula","name","ciudadela","etapa"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Guardias"),t.qZA(),t.TgZ(3,"div",1)(4,"div",2)(5,"span",3),t._uU(6,"Ciudadela"),t.qZA()(),t.YNc(7,Z,5,1,"select",4),t.YNc(8,T,2,1,"label",5),t.qZA(),t.TgZ(9,"div",1)(10,"div",2)(11,"span",3),t._uU(12,"Etapa"),t.qZA()(),t.YNc(13,x,5,1,"select",6),t.YNc(14,A,2,1,"label",5),t.qZA(),t.TgZ(15,"div",1),t.YNc(16,$,2,0,"button",7),t.qZA(),t.TgZ(17,"div",1)(18,"input",8),t.NdJ("ngModelChange",function(o){return i.name=o}),t.qZA(),t.TgZ(19,"button",9),t.NdJ("click",function(){return i.busqueda()}),t._uU(20," Buscar "),t.qZA()(),t.TgZ(21,"div",10)(22,"a",11),t._uU(23," Crear nuevo guardia "),t.qZA(),t.YNc(24,U,3,6,"div",12),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("appMenurole",t.DdM(8,v)),t.xp6(1),t.Q6J("appMenurole",t.DdM(9,b)),t.xp6(5),t.Q6J("appMenurole",t.DdM(10,v)),t.xp6(1),t.Q6J("appMenurole",t.DdM(11,b)),t.xp6(2),t.Q6J("appMenurole",t.DdM(12,v)),t.xp6(2),t.Q6J("ngModel",i.name),t.xp6(4),t.Q6J("routerLink",t.DdM(13,E)),t.xp6(2),t.Q6J("ngForOf",i.guardias))},directives:[f,d.YN,d.Kr,c.sg,d.Fj,d.JJ,d.On,s.yS,G],styles:[""]}),a})()},{path:"",redirectTo:"guardias"}];let I=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[s.Bz.forChild(B)],s.Bz]}),a})(),F=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[c.ez,I,d.u5]]}),a})()},9709:(C,g,u)=>{u.d(g,{D:()=>m});var c=u(2340),d=u(5e3),t=u(520),_=u(8553);let m=(()=>{class l{constructor(s,p){this.http=s,this.authServ=p,this.url=c.N.BASE_URL}validateUser(s){return console.log(`${this.url}users/new`,s),this.http.post(`${this.url}users/new`,s)}getEtapas(){return this.http.get(this.url+"etapas/all")}findEtapasByCiudadelaId(s){return console.log(`${this.url}etapas/ciudadela?ciudadela=${s}`),this.http.get(`${this.url}etapas/ciudadela?ciudadela=${s}`)}findEtapasById(s){return console.log(`${this.url}etapas/${s}`),this.http.get(`${this.url}etapas/${s}`)}findEtapaByName(s){return console.log(`${this.url}etapas/name?name=${s}`),this.http.get(`${this.url}etapas/name?name=${s}`)}newEtapa(s){return console.log(`${this.url}etapas/new`,s),this.http.post(`${this.url}etapas/new`,s)}findViviendaById(s){return console.log(`${this.url}viviendas/${s}`),this.http.get(`${this.url}viviendas/${s}`)}findViviendaByEtapa(s){return console.log(`${this.url}viviendas/search/etapa?etapa=${s}`),this.http.get(`${this.url}viviendas/search/etapa?etapa=${s}`)}newVivienda(s){return console.log(`${this.url}viviendas/new`,s),this.http.post(`${this.url}viviendas/new`,s)}updateVivienda(s,p){return console.log(`${this.url}viviendas/${s}`,p),this.http.put(`${this.url}viviendas/${s}`,p)}deleteVivienda(s){return console.log(`${this.url}viviendas/${s}`),this.http.delete(`${this.url}viviendas/${s}`)}getCiudadelas(){return this.http.get(this.url+"ciudadelas/all")}findCiudadelaById(s){return console.log(`${this.url}ciudadelas/${s}`),this.http.get(`${this.url}ciudadelas/${s}`)}}return l.\u0275fac=function(s){return new(s||l)(d.LFG(t.eN),d.LFG(_.e))},l.\u0275prov=d.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);